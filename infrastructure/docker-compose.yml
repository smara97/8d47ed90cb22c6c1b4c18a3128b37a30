# ============================================================================
# Video RAG Microservices - Master Infrastructure Compose
# ============================================================================

name: video-rag
#
# PURPOSE:
#   Orchestrates all core infrastructure services required for the Video RAG
#   microservices architecture. This is the foundation layer that must be
#   running before any application services can start.
#
# ARCHITECTURE:
#   Event-driven microservices using Kafka as the message backbone:
#
#   Video Input → Frame Producer → Kafka Topics → Vision Services →
#   Aggregator → Summarizer → Segmenter → RAG Storage (Qdrant)
#
# INCLUDED SERVICES:
#   1. Zookeeper     - Kafka cluster coordination and metadata management
#   2. Kafka         - Message broker for event streaming between services
#   3. Kafka UI      - Web dashboard for monitoring topics and messages
#   4. MinIO         - S3-compatible object storage for models and video files
#   5. Qdrant        - Vector database for RAG embeddings and similarity search
#
# NETWORK TOPOLOGY:
#   All services communicate via 'video-rag-network' bridge network
#   External access via mapped ports (see .env for port configuration)
#
# USAGE:
#   # Start infrastructure only (recommended for development)
#   docker-compose -f infrastructure/docker-compose.yml --env-file infrastructure/.env up -d
#
#   # Check health status
#   ./scripts/health-check.sh
#
#   # View logs
#   docker-compose -f infrastructure/docker-compose.yml logs -f
#
# DEPENDENCIES:
#   - Docker 20.10+
#   - Docker Compose 2.0+
#   - Environment file: infrastructure/.env
#   - Network: video-rag-network (auto-created)
#
# MONITORING:
#   - Kafka UI:      http://localhost:8080
#   - MinIO Console: http://localhost:9001
#   - Qdrant API:    http://localhost:6333
#
# ============================================================================

include:
  # Core coordination service - must start first
  - path: ./components/zookeeper.yml

  # Message broker - depends on Zookeeper
  - path: ./components/kafka.yml

  # Kafka monitoring dashboard - depends on Kafka
  - path: ./components/kafka-ui.yml

  # Object storage for models and video segments
  - path: ./components/minio.yml

  # Vector database for RAG embeddings
  - path: ./components/qdrant.yml
